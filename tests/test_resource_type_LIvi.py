#!/usr/bin/env python3


from pylavi.resource_types import TypeLIvi


def test_LIvi():
    for test_index, binary in enumerate(TEST_CASES):
        livi = TypeLIvi().from_bytes(binary)
        assert livi.to_bytes() == binary
        description = livi.to_value()
        reconstituted = TypeLIvi().from_value(description)
        assert reconstituted.to_bytes() == binary, [description, reconstituted, livi, reconstituted.to_bytes(), binary]
        assert reconstituted.size() == len(binary)

    binary = b'\x00\x01LVIN\x1ftestDragOrderBetweenProjects.vi\x00\x00\x00\x00\x00\x01\x00\x02VIVI\x00\x00\x00\x00\x00\x01\x11subSetItemPath.viPTH0\x00\x00\x00\x17\x00\x01\x00\x02\x00\x11subSetItemPath.vi\x00\x00\x00\x00\x00\x01\x00\x00\x00\x01\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03'
    livi = TypeLIvi().from_bytes(binary)
    expected_str = ""
    assert str(livi) == expected_str, [str(livi), expected_str]
    expected_repr = ""
    assert repr(livi) == expected_repr, [repr(livi), expected_repr]


TEST_CASES = {
    b'\x00\x01LVIN\x1ftestDragOrderBetweenProjects.vi\x00\x00\x00\x00\x00\x01\x00\x02VIVI\x00\x00\x00\x00\x00\x01\x11subSetItemPath.viPTH0\x00\x00\x00\x17\x00\x01\x00\x02\x00\x11subSetItemPath.vi\x00\x00\x00\x00\x00\x01\x00\x00\x00\x01\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03': {},
    b'\x00\x01LVIN\x1ftestDDTPrimitivesSubClustDDT.vi\x00\x00\x00\x00\x00\x02\x00\x02VIVI\x00\x00\x00\x00\x00\x01 testddtprimitivesSubFixupNANs.vi\x00PTH0\x00\x00\x00&\x00\x01\x00\x02\x00 testddtprimitivesSubFixupNANs.vi\x00\x00\x00\x00\x00\x01\x00\x00\x00\x01\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02VIVI\x00\x00\x00\x00\x00\x00\x02\x08Instance?Instance           1 36Saved   testDDTPrimitivesSubClustDDT .vi\x00PTH0\x00\x00\x00D\x00\x01\x00\x01?Instance           1 36Saved   testDDTPrimitivesSubClustDDT .vi\x00\x00\x00\x01\x00\x02\x00\x00\x00\x01\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03': {},
    b'\x00\x01LVIN\x1ftestDragFolderOfIllegalItems.vi\x00\x00\x00\x00\x00\x01\x00\x02VIVI\x00\x00\x00\x00\x00\x01\x14subOpenProjToTest.vi\x00PTH0\x00\x00\x00\x1b\x00\x01\x00\x03\x00\x00\x14subOpenProjToTest.vi\x00\x00\x00\x00\x00\x01\x00\x00\x00\x01\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03': {},
}


if __name__ == "__main__":
    test_LIvi()
